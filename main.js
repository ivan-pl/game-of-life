!function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var n=function(){function n(t,l){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e(this,n),i(this,"isActive",!1),this.gameModel=t,this.gameView=l,this.speed=r,this.gameView.initialize(this)}var l,r;return l=n,(r=[{key:"getField",value:function(){return this.gameModel.getState()}},{key:"onCellClick",value:function(e,t){this.gameModel.toggleCellState(e,t)}},{key:"onActivationClick",value:function(){this.isActive?this.stopAction():this.startAction()}},{key:"startAction",value:function(){var e=this;this.isActive=!0,this.timerId=window.setInterval((function(){e.gameModel.nextGeneration()||(e.stopAction(),alert("Игра закончена"),e.newGame());var t=e.gameModel.getState();e.gameView.updateField(t)}),1e3*this.speed)}},{key:"stopAction",value:function(){this.isActive=!1,window.clearInterval(this.timerId)}},{key:"newGame",value:function(){this.gameModel.clearField();var e=this.gameModel.getState();this.gameView.updateField(e),this.gameView.setButtonStart()}},{key:"changeSize",value:function(e,t){this.gameModel.setSize(e,t),this.gameView.setSize(e,t);var i=this.gameModel.getState();this.gameView.updateField(i)}},{key:"changeSpeed",value:function(e){this.speed=e,this.isActive&&(this.stopAction(),this.startAction())}},{key:"getSpeed",value:function(){return this.speed}},{key:"fillRandomly",value:function(){for(var e=this.getField(),t=0;t<e.length;t++)for(var i=0;i<e[t].length;i++)Math.random()>.5&&this.gameModel.toggleCellState(i,t);var n=this.getField();this.gameView.updateField(n)}}])&&t(l.prototype,r),Object.defineProperty(l,"prototype",{writable:!1}),n}();function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;l(this,e),o(this,"field",[]),o(this,"prevField",[]);for(var n=0;n<i;n++)this.field.push(new Array(t).fill(0));this.prevField=this.field}var t,i;return t=e,(i=[{key:"getState",value:function(){return this.field.map((function(e){return e.slice()}))}},{key:"toggleCellState",value:function(e,t){1===this.field[t][e]?this.field[t][e]=0:this.field[t][e]=1}},{key:"isInsideField",value:function(e,t){return!(e<0||t<0||t>=this.field.length||e>=this.field[0].length)}},{key:"countNeighbors",value:function(e,t){for(var i=0,n=t-1;n<=t+1;n++)for(var l=e-1;l<=e+1;l++)!this.isInsideField(l,n)||n===t&&l===e||1===this.field[n][l]&&(i+=1);return i}},{key:"nextGeneration",value:function(){for(var e=[],t=!0,i=0;i<this.field.length;i++){e.push(new Array(this.field[0].length).fill(0));for(var n=0;n<this.field[0].length;n++){var l=this.countNeighbors(n,i);0===this.field[i][n]?e[i][n]=3===l?1:0:e[i][n]=2===l||3===l?1:0,t&&e[i][n]!==this.field[i][n]&&(t=!1)}}return this.prevField=this.field,this.field=e,!t}},{key:"setSize",value:function(e,t){for(var i=[],n=0;n<t;n++){i.push(new Array(e));for(var l=0;l<e;l++){var r,o;i[n][l]=null!==(r=null===(o=this.field[n])||void 0===o?void 0:o[l])&&void 0!==r?r:0}}this.field=i}},{key:"clearField",value:function(){for(var e=0;e<this.field.length;e++)for(var t=0;t<this.field[e].length;t++)this.field[e][t]=0}}])&&r(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,l,r=[],o=!0,a=!1;try{for(i=i.call(e);!(o=(n=i.next()).done)&&(r.push(n.value),!t||r.length!==t);o=!0);}catch(e){a=!0,l=e}finally{try{o||null==i.return||i.return()}finally{if(a)throw l}}return r}}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=c(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,l=function(){};return{s:l,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:l}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o=!0,a=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return o=e.done,e},e:function(e){a=!0,r=e},f:function(){try{o||null==i.return||i.return()}finally{if(a)throw r}}}}function c(e,t){if(e){if("string"==typeof e)return d(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function f(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var h=function(){function e(t){var i,n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.field=t,this.actionButton=document.getElementById("action"),this.actionButton.addEventListener("click",(function(e){n.onActionClick(e)})),this.setSizeButton=document.getElementById("set-size"),this.setSizeButton.addEventListener("click",(function(){n.onSetSizeClick()})),this.clearButton=document.getElementById("clear"),this.clearButton.addEventListener("click",(function(){return n.onClearClick()})),null===(i=document.getElementById("fill-randomly"))||void 0===i||i.addEventListener("click",(function(){return n.onFillRandomlyClick()})),this.inputWidth=document.getElementById("width"),this.inputHeight=document.getElementById("height"),this.inputSpeed=document.getElementById("speed"),this.outputSpeed=document.getElementById("speed-output"),this.inputSpeed.addEventListener("input",(function(){n.onSpeedChange()}))}var t,i,n;return t=e,n=[{key:"getCoordinates",value:function(e){return e.getAttribute("coordinates").split(" ").map((function(e){return Number(e)}))}}],(i=[{key:"initialize",value:function(e){this.gameController=e;var t=this.gameController.getField();this.setSize(t[0].length,t.length),this.updateField(t)}},{key:"updateField",value:function(t){var i,n=s(this.field.querySelectorAll(".field__cell"));try{for(n.s();!(i=n.n()).done;){var l=i.value,r=u(e.getCoordinates(l),2),o=r[0];1===t[r[1]][o]?l.classList.add("field__cell--alive"):l.classList.remove("field__cell--alive")}}catch(e){n.e(e)}finally{n.f()}}},{key:"setSize",value:function(e,t){var i=this;this.field.textContent="";for(var n=0;n<t;n++){for(var l=0;l<e;l++){var r=document.createElement("div");r.classList.add("field__cell"),r.setAttribute("coordinates","".concat(l," ").concat(n)),r.addEventListener("click",(function(e){i.onCellClick(e)})),this.field.append(r)}n<t-1&&this.field.append(document.createElement("br"))}}},{key:"onCellClick",value:function(t){var i,n=t.target;n.classList.toggle("field__cell--alive");var l=u(e.getCoordinates(n),2),r=l[0],o=l[1];null===(i=this.gameController)||void 0===i||i.onCellClick(r,o),this.disablingButtons()}},{key:"onActionClick",value:function(e){var t,i=e.target;i.innerText="Start"===i.innerText?"Stop":"Start",null===(t=this.gameController)||void 0===t||t.onActivationClick()}},{key:"disablingButtons",value:function(){this.field.querySelector(".field__cell--alive")?(this.clearButton.disabled=!1,this.actionButton.disabled=!1):(this.clearButton.disabled=!0,this.actionButton.disabled=!0)}},{key:"setButtonStart",value:function(){this.actionButton.innerText="Start"}},{key:"onSetSizeClick",value:function(){var e,t=+this.inputWidth.value,i=+this.inputHeight.value;null===(e=this.gameController)||void 0===e||e.changeSize(t,i)}},{key:"onSpeedChange",value:function(){var e,t=this.inputSpeed.value;this.outputSpeed.innerText="".concat(t," s"),null===(e=this.gameController)||void 0===e||e.changeSpeed(+t)}},{key:"onFillRandomlyClick",value:function(){var e;null===(e=this.gameController)||void 0===e||e.fillRandomly(),this.disablingButtons()}},{key:"onClearClick",value:function(){var e,t=s(this.field.querySelectorAll(".field__cell--alive"));try{for(t.s();!(e=t.n()).done;)e.value.dispatchEvent(new Event("click"))}catch(e){t.e(e)}finally{t.f()}}}])&&f(t.prototype,i),n&&f(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),v=document.querySelector(".field");new n(new a(7,7),new h(v))}();