!function(){"use strict";function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var n=function(){function n(t,r){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e(this,n),i(this,"isActive",!1),this.gameModel=t,this.gameView=r,this.speed=l,this.gameView.initialize(this)}var r,l;return r=n,(l=[{key:"getField",value:function(){return this.gameModel.getState()}},{key:"onCellClick",value:function(e,t){this.gameModel.toggleCellState(e,t)}},{key:"onActivationClick",value:function(){this.isActive?this.stopAction():this.startAction()}},{key:"startAction",value:function(){var e=this;this.isActive=!0,this.timerId=window.setInterval((function(){e.gameModel.nextGeneration(),e.gameModel.isGameFinished()&&(e.stopAction(),alert("Игра закончена"),e.newGame());var t=e.gameModel.getState();e.gameView.updateField(t)}),1e3*this.speed)}},{key:"stopAction",value:function(){this.isActive=!1,window.clearInterval(this.timerId)}},{key:"newGame",value:function(){this.gameModel.clearField();var e=this.gameModel.getState();this.gameView.updateField(e),this.gameView.setButtonStart()}}])&&t(r.prototype,l),Object.defineProperty(r,"prototype",{writable:!1}),n}();function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function o(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;r(this,e),o(this,"field",[]),o(this,"prevField",[]);for(var n=0;n<i;n++)this.field.push(new Array(t).fill(0));this.prevField=this.field}var t,i;return t=e,(i=[{key:"getState",value:function(){return this.field}},{key:"toggleCellState",value:function(e,t){1===this.field[t][e]?this.field[t][e]=0:this.field[t][e]=1}},{key:"isInsideField",value:function(e,t){return!(e<0||t<0||t>=this.field.length||e>=this.field[0].length)}},{key:"countNeighbors",value:function(e,t){for(var i=0,n=t-1;n<=t+1;n++)for(var r=e-1;r<=e+1;r++)!this.isInsideField(r,n)||n===t&&r===e||1===this.field[n][r]&&(i+=1);return i}},{key:"nextGeneration",value:function(){for(var e=[],t=0;t<this.field.length;t++){e.push(new Array(this.field[0].length).fill(0));for(var i=0;i<this.field[0].length;i++){var n=this.countNeighbors(i,t);0===this.field[t][i]?e[t][i]=3===n?1:0:e[t][i]=2===n||3===n?1:0}}this.prevField=this.field,this.field=e}},{key:"setSize",value:function(e,t){for(var i=[],n=0;n<t;n++){i.push(new Array(e));for(var r=0;r<e;r++){var l,o;i[n][r]=null!==(l=null===(o=this.field[n])||void 0===o?void 0:o[r])&&void 0!==l?l:0}}this.field=i}},{key:"isGameFinished",value:function(){for(var e=0;e<this.field.length;e++)for(var t=0;t<this.field[e].length;t++)if(this.field[e][t]!==this.prevField[e][t])return!1;return!0}},{key:"clearField",value:function(){for(var e=0;e<this.field.length;e++)for(var t=0;t<this.field[e].length;t++)this.field[e][t]=0}}])&&l(t.prototype,i),Object.defineProperty(t,"prototype",{writable:!1}),e}();function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,r,l=[],o=!0,a=!1;try{for(i=i.call(e);!(o=(n=i.next()).done)&&(l.push(n.value),!t||l.length!==t);o=!0);}catch(e){a=!0,r=e}finally{try{o||null==i.return||i.return()}finally{if(a)throw r}}return l}}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return f(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var d=function(){function e(t){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.field=t,this.actionButton=document.getElementById("action"),this.actionButton.addEventListener("click",(function(e){i.onActionClick(e)}))}var t,i,n;return t=e,n=[{key:"getCoordinates",value:function(e){return e.getAttribute("coordinates").split(" ").map((function(e){return Number(e)}))}}],(i=[{key:"initialize",value:function(e){this.gameController=e;var t=this.gameController.getField();this.setSize(t[0].length,t.length),this.updateField(t)}},{key:"updateField",value:function(t){var i,n=function(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=c(e))){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,a=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return o=e.done,e},e:function(e){a=!0,l=e},f:function(){try{o||null==i.return||i.return()}finally{if(a)throw l}}}}(this.field.querySelectorAll(".field__cell"));try{for(n.s();!(i=n.n()).done;){var r=i.value,l=u(e.getCoordinates(r),2),o=l[0];1===t[l[1]][o]?r.classList.add("field__cell--alive"):r.classList.remove("field__cell--alive")}}catch(e){n.e(e)}finally{n.f()}}},{key:"setSize",value:function(e,t){var i=this;this.field.textContent="";for(var n=0;n<t;n++){for(var r=0;r<e;r++){var l=document.createElement("div");l.classList.add("field__cell"),l.setAttribute("coordinates","".concat(r," ").concat(n)),l.addEventListener("click",(function(e){i.onCellClick(e)})),this.field.append(l)}n<t-1&&this.field.append(document.createElement("br"))}}},{key:"onCellClick",value:function(t){var i,n=t.target;n.classList.toggle("field__cell--alive");var r=u(e.getCoordinates(n),2),l=r[0],o=r[1];null===(i=this.gameController)||void 0===i||i.onCellClick(l,o)}},{key:"onActionClick",value:function(e){var t,i=e.target;i.innerText="Start"===i.innerText?"Stop":"Start",null===(t=this.gameController)||void 0===t||t.onActivationClick()}},{key:"setButtonStart",value:function(){this.actionButton.innerText="Start"}}])&&s(t.prototype,i),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),h=document.querySelector(".field");new n(new a(7,7),new d(h))}();